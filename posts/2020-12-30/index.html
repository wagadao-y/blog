<!doctype html><html lang=ja><head><meta charset=utf-8><title>mitsuki-n's Blog</title><link rel=stylesheet href=https://mitsuki-n.github.io/blog/css/reset.css><link rel=stylesheet href=https://mitsuki-n.github.io/blog/css/style.css></head><body><header><a href=https://mitsuki-n.github.io/blog/index.html class=header-title><div>mitsuki-n's Blog</div></a></header><main><article><h1>VSCode拡張機能開発　現在開いているドキュメントのテキスト取得方法</h1><p>document.getText(取得範囲)でドキュメントのテキストを取得できる。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=color:#a6e22e>extension</span>.<span style=color:#a6e22e>ts</span>
<span style=color:#66d9ef>export</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>activate</span>(<span style=color:#a6e22e>context</span>: <span style=color:#66d9ef>vscode.ExtensionContext</span>) {
    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>disposable</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vscode</span>.<span style=color:#a6e22e>commands</span>.<span style=color:#a6e22e>registerCommand</span>(<span style=color:#e6db74>&#39;helloworld.helloWorld&#39;</span>, () <span style=color:#f92672>=&gt;</span> {
        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>editor</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vscode</span>.window.<span style=color:#a6e22e>activeTextEditor</span>;

        <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>editor</span>){
            <span style=color:#66d9ef>const</span> document <span style=color:#f92672>=</span> <span style=color:#a6e22e>editor</span>.document;

            <span style=color:#75715e>// 現在開いているドキュメント全体の文字列を取得
</span><span style=color:#75715e></span>            <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>firstLine</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>lineAt</span>(<span style=color:#ae81ff>0</span>);
            <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>lastLine</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>lineAt</span>(document.<span style=color:#a6e22e>lineCount</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>);
            <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>textRange</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>vscode</span>.<span style=color:#a6e22e>Range</span>(<span style=color:#a6e22e>firstLine</span>.<span style=color:#a6e22e>range</span>.<span style=color:#a6e22e>start</span>, <span style=color:#a6e22e>lastLine</span>.<span style=color:#a6e22e>range</span>.<span style=color:#a6e22e>end</span>);
            <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>text</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>getText</span>(<span style=color:#a6e22e>textRange</span>);

            <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>text</span>);
        }
    });

    <span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>subscriptions</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>disposable</span>);
}
</code></pre></div><p>参考ページ<br>VSCode公式の拡張機能開発チュートリアル
yo codeで生成したHelloWorld拡張機能のextension.tsの上記部分を書き換えればOK</p><p><a href=https://code.visualstudio.com/api/get-started/your-first-extension>https://code.visualstudio.com/api/get-started/your-first-extension</a></p><p>VSCodeで開いているドキュメント全体の範囲を取得する方法</p><p><a href=https://stackoverflow.com/questions/45203543/vs-code-extension-api-to-get-the-range-of-the-whole-text-of-a-document>https://stackoverflow.com/questions/45203543/vs-code-extension-api-to-get-the-range-of-the-whole-text-of-a-document</a></p></article></main></body></html>